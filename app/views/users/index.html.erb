<div class="w-full">
  <!-- Header Section -->
  <div class="mb-8">
    <h1 class="text-4xl font-black uppercase tracking-tight text-gray-900 dark:text-white mb-2">Community</h1>
    <p class="text-gray-600 dark:text-gray-400 text-lg">Meet the explorers, creators, and adventurers</p>
  </div>

  <!-- Stats & Filter Bar -->
  <div class="mb-8 grid md:grid-cols-4 gap-4">
    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="text-3xl font-black text-emerald-600 dark:text-emerald-400"><%= @users.count %></div>
      <div class="text-sm text-gray-600 dark:text-gray-400 uppercase tracking-wide">Total Members</div>
    </div>
    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="text-3xl font-black text-blue-600 dark:text-blue-400"><%= @groups.count %></div>
      <div class="text-sm text-gray-600 dark:text-gray-400 uppercase tracking-wide">Active Groups</div>
    </div>
    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="text-3xl font-black text-purple-600 dark:text-purple-400"><%= Task.count %></div>
      <div class="text-sm text-gray-600 dark:text-gray-400 uppercase tracking-wide">Tasks Created</div>
    </div>
    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
      <div class="text-3xl font-black text-orange-600 dark:text-orange-400"><%= Task.where(status: 'completed').count %></div>
      <div class="text-sm text-gray-600 dark:text-gray-400 uppercase tracking-wide">Completed</div>
    </div>
  </div>

  <!-- Group Filter Pills -->
  <div class="mb-6 flex flex-wrap items-center gap-3">
    <span class="text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide">Groups:</span>
    <%= link_to users_path, class: "group-filter-btn #{params[:group].blank? ? 'active bg-gray-900 dark:bg-gray-700 text-white' : 'bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-700'} px-4 py-2 text-sm font-medium rounded-full transition" do %>
      All
    <% end %>
    <% @groups.each do |group| %>
      <%= link_to users_path(group: group), class: "group-filter-btn #{params[:group] == group ? 'active bg-gray-900 dark:bg-gray-700 text-white' : 'bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-700'} px-4 py-2 text-sm font-medium rounded-full transition" do %>
        <%= group %>
      <% end %>
    <% end %>
  </div>

  <!-- Users Grid -->
  <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
    <% @users.each_with_index do |user, index| %>
      <%
        # Cycle through colors for variety
        colors = ['emerald', 'blue', 'purple', 'orange', 'pink', 'indigo']
        color = colors[index % colors.length]

        # Group badge colors
        group_colors = {
          'Urban Nomads' => { bg: 'emerald', text: 'emerald' },
          'Digital Alchemists' => { bg: 'purple', text: 'purple' },
          'Street Philosophers' => { bg: 'blue', text: 'blue' },
          'Midnight Architects' => { bg: 'indigo', text: 'indigo' },
          'Concrete Poets' => { bg: 'orange', text: 'orange' }
        }
        group_color = group_colors[user.group] || { bg: 'gray', text: 'gray' }
      %>

      <%
        # Group-specific icons and styling
        group_info = {
          'Urban Nomads' => { icon: 'ðŸ™ï¸', tagline: 'Wanderers of concrete jungles', border: 'emerald' },
          'Digital Alchemists' => { icon: 'âš—ï¸', tagline: 'Transforming bits into experiences', border: 'purple' },
          'Street Philosophers' => { icon: 'ðŸ’­', tagline: 'Seeking wisdom in urban spaces', border: 'blue' },
          'Midnight Architects' => { icon: 'ðŸŒ™', tagline: 'Building dreams after dark', border: 'indigo' },
          'Concrete Poets' => { icon: 'âœï¸', tagline: 'Writing verses on city walls', border: 'orange' }
        }
        info = group_info[user.group] || { icon: 'ðŸ‘¤', tagline: 'Explorer', border: 'gray' }
      %>

      <div class="user-card bg-white dark:bg-gray-800 border-2 border-<%= info[:border] %>-200 dark:border-<%= info[:border] %>-800 rounded-xl p-6 hover:shadow-lg hover:border-<%= info[:border] %>-400 dark:hover:border-<%= info[:border] %>-600 transition group" data-user-group="<%= user.group %>">
        <!-- Group Icon Header -->
        <div class="flex items-center justify-between mb-4">
          <div class="text-3xl"><%= info[:icon] %></div>
          <% if user.group.present? %>
            <span class="px-3 py-1 bg-<%= group_color[:bg] %>-100 dark:bg-<%= group_color[:bg] %>-900/30 text-<%= group_color[:text] %>-700 dark:text-<%= group_color[:text] %>-400 text-xs font-bold uppercase rounded-full">
              <%= user.group %>
            </span>
          <% end %>
        </div>

        <!-- Avatar & Name -->
        <div class="flex items-start gap-4 mb-3">
          <div class="flex-shrink-0 w-16 h-16 bg-<%= group_color[:bg] %>-500 rounded-full flex items-center justify-center text-white text-2xl font-bold shadow-lg">
            <%= user.email[0].upcase %>
          </div>
          <div class="flex-1 min-w-0">
            <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate">
              <%= user.email.split('@').first %>
            </h3>
            <p class="text-xs text-gray-500 dark:text-gray-400 italic mt-1">
              <%= info[:tagline] %>
            </p>
          </div>
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-3 gap-3 mb-4 pt-4 border-t border-gray-200 dark:border-gray-700">
          <div class="text-center">
            <div class="text-xl font-bold text-gray-900 dark:text-white"><%= user.tasks.count %></div>
            <div class="text-xs text-gray-500 dark:text-gray-400 uppercase">Tasks</div>
          </div>
          <div class="text-center">
            <div class="text-xl font-bold text-gray-900 dark:text-white"><%= user.tasks.sum(:upvotes_count) %></div>
            <div class="text-xs text-gray-500 dark:text-gray-400 uppercase">Upvotes</div>
          </div>
          <div class="text-center">
            <div class="text-xl font-bold text-gray-900 dark:text-white"><%= user.tasks.sum(:submissions_count) %></div>
            <div class="text-xs text-gray-500 dark:text-gray-400 uppercase">Submissions</div>
          </div>
        </div>

        <!-- Member Since -->
        <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
          <span>Joined <%= time_ago_in_words(user.created_at) %> ago</span>
          <button class="text-emerald-600 dark:text-emerald-400 hover:underline font-medium">
            View Profile â†’
          </button>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Pagination -->
  <div class="mt-8 flex items-center justify-center gap-2">
    <button class="px-4 py-2 border border-gray-300 dark:border-gray-700 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition disabled:opacity-50" disabled>
      Previous
    </button>
    <button class="px-4 py-2 bg-emerald-500 text-black font-bold rounded">
      1
    </button>
    <button class="px-4 py-2 border border-gray-300 dark:border-gray-700 rounded text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 transition">
      Next
    </button>
  </div>


</div>
